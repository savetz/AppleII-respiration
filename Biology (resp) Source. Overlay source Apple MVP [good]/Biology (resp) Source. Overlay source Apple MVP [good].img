\                        <12/17/86>140                                                                                  BEGIN                                     SERIES-INIT                             EXPER-TYPE 2 LET TINT := 0              BEGIN         9 THRU \ CFORM                    230 237 THRU \ explode                2 !OVERLAY 0OVERLAY                                                                                                                                                                             : XCREATE CREATE ;                                                                                                                                                                                                                                              5 START-OV                                200 209 THRU \ animated ion             240 246 THRU \ turnkey                1 !OVERLAY 0OVERLAY                                                             5 START-OV                                210 22                                                                : X' [COMPILE] '                        ; IMMEDIATE                                                                     : XVARIABLE VARIABLE ;                  : XCONSTANT CONSTANT ;           0:kreb's cycle lab       180 184 THRU \ 2:Glycolsis lab          185 189 THRU \ 1:latic acid lab         190 191 THRU \ 3:Electron trans lab     195 196 THRU \ cleanup                0 !OVERLAY 0OVERLAY                                                     \ TO NULLIFY X WORDS     <11/19/86>143                                                                                  : X: [COMPILE] : ;                                                              : X; [COMPILE] ;                        ; IMMEDIATE     \ LOADBLOCK              < 9/15/87>141  PAGE        ." RUN/COMPILE IN DRIVE A - PRESS A KEY" KEY DROP INSDISK PAGE      ." Loading BIOLOGY Overlays" CR CR CR   9 ' OVSECTS !                           10 START-OV                               165 179 THRU \                                                                                                                                                                                                                                                                                                END                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          CLS PR-RESULTS PRINT "JSDJS"            PR-INTS PRINT "ASDJH"                   SCREEN-DONE                            ENDIF                                  ENDIF                                   REPEAT                                 END    Drk reac cycle anim    1 !OVERLAY 0OVERLAY                                                                                                                                                                                                                                             \  SET-INT# TINT                           GET-RESULT                              IF NOT FLAG THEN                         LET TINT := TINT + 2                    NEXT-EXPER                              IF FLAG THEN MODE 5         \ LOADBLOCK              <11/ 6/86>142                                          \ 1:misc stuff                          15 START-OV                               150 151 THRU \ reaction timer           155 164 THRU \ animated ion             225 234 THRU \                                                                                                                                                                                       \ FAH                                                                    \ SPECIAL TEST CODE      < 9/15/87>144                                          : DEMON ( -- )                            49250 C@ 127 > ( CLSD APPLE? )          IF TEXT CR                               ." RP@ = " RP@ U.                       ." SP@ = " SP                                                                                                                                                                                       \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ RUN PATCH              <11/ 6/86>145                                          : RUN                                     [ ' VARIABLES @ ] LITERAL               ' VARIABLES !                           0OVERLAY                                RUN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   49152 C@ 127 > ;                                                              : DQ DEMON DOQTERM ;                    ' DQ CFA ' QTERM CF 8 CMOVE                                                                                                                                                                                                                                                                                                                                                                     @ U.                       ." GSTACK = " EXEC GSTACK @ U. FORTH    BEGIN 49250 C@ 127 > NOT                UNTIL HG                               THEN ;                                                                        : DOQTERM ( -- DOES QTERM )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             X: TOPIX ( N -- P )                       48 80 */ X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              M/R + C@ X;                                                                                                          \ convert answer to range of pixels     \ for manometer                         \ 0<=N<=80   0<=P<=48           \ mul of 7 (bytes)      0 XCONSTANT GPY                                                                                                         XCREATE M/R                                                                     \ data on next screen           \ BUB/MIN                < 7/ 6/87>167                                            \ Extract value from table              \ INT# is the speed (0-20)              \ TEMP# selects mouse(0)/rat(1)       X: ML/G/HR ( i -- n )                      2* TEMP# @ + \ experiment vars        < 7/ 6/87>165  [EXEC]                                                                          XVARIABLE CLKXY 0 , 5 , \ X,Y,MODE                                              \ position of manometer graphic         0 XCONSTANT GPX   70 C, 33 C,                   ( 1.8 )   73 C, 35 C,                   ( 1.9 )   75 C, 36 C,                   ( 2.0 )   77 C, 37 C,                                                  \ FAH                                                                                                                                                                                                                                                                                                                                            ( 1.1 )   57 C, 26 C,                   ( 1.2 )   59 C, 27 C,                   ( 1.3 )   61 C, 28 C,                   ( 1.4 )   64 C, 30 C,                   ( 1.5 )   66 C, 31 C,                   ( 1.6 )   68 C, 32 C,                   ( 1.7 )                                                                                                                                                                                                                                                                 17 C,                   ( 0.5 )   43 C, 18 C,                   ( 0.6 )   45 C, 19 C,                   ( 0.7 )   48 C, 21 C,                   ( 0.8 )   50 C, 22 C,                   ( 0.9 )   52 C, 23 C,                   ( 1.0 )   55 C, 24 C,                                                                                                                                                                                                                                                                           \ RAT MOUSE DATA TABLE   < 7/ 6/87>166  ( k/h ) ( mouse rat - ml/g/hr*10 )      ( 0.0 )   32 C, 12 C,                   ( 0.1 )   34 C, 13 C,                   ( 0.2 )   37 C, 14 C,                   ( 0.3 )   39 C, 16 C,                   ( 0.4 )   41 C,                                                                                                                                                                                                                                                                 \ ANIMATION WORDS        < 7/ 6/87>168  \ routines to animate manometer                                                 \ draw bar relative to graphic post'n   X: MYBAR ( W H X Y -- )                    SWAP GPX + SWAP GPY + BAR X;                          7 1 68 74 I - MYBAR LOOP       X;                                                                                                                                                                                                                                      X: RUN1 40 <RUN1> X;                                                            \ if cycle is a multiple of ANDEL       \ draw next animation cycle             X: RUNAN ( CYCLE -- )                     RUNDEL MOD 0=                           IF RUN           6 I - 2* 35 + I 2 < - 1 \ W H           68 I + I 2 < + 78 I + MYBAR            LOOP                                    10 1 68 76 MYBAR                        8  1 68 75 MYBAR                        8  1 68 74 MYBAR                        5 0 DO#                                                               X: <RUN1> ( YOFF -- )                      >R RUN# @ 2* GADRS + @ PACKBUF DROP     GPX 7 / GPY R> + UNPACK PACK-DONE       RUN# @ 1 + 3 MOD RUN# ! X;                                                                     74 15 DO 7 1 108 I MYBAR LOOP           8 1 107 74 MYBAR                        10 1 105 75 MYBAR                       11 1 104 76 MYBAR                       47 1  68 77 MYBAR                       6 0 DO                        \ ANIMATION WORDS        < 7/ 8/87>171  \ words to animate rat/mouse                                                       \ move mouse every RUNDEL cycles     10 XCONSTANT RUNDEL                        \ Current animation index               XVARIABLE RUN\ ANIMATION WORDS        < 7/ 7/87>169  \ fills manometer to inital state                                               X: FILLMAN ( -- )                         4 HCOLOR 70 15                          DO 7 1 68 I MYBAR LOOP                  7 HCOLOR                                        MANDEL2 MOD 0=                          IF -1 MAN# +! THEN                    X;                                                                                                                                                                                                                                                                                                                                                                                                                        DUP MANDEL MOD 0=                       IF MAN# @ BDRAW                          MAN# @ DUP MANANS <                     IF 1+ MAN# ! ELSE DROP THEN            ELSE                                     100 0 DO NOOP NOOP LOOP                THEN             >R 7 1 68 R> 15 + MYBAR X;                                                   \ add one line to left, remove from rt  X: BDRAW ( N -- )                          7 HCOLOR DUP 54 SWAP - LDRAW            4 HCOLOR RDRAW X;                            DEL                        \ dec value every n cycles           20 XCONSTANT MANDEL2                       \ current manometer value               XVARIABLE MAN#                                                               X: MANAN ( CYCLE -- )                                   \ draw line in man'mtr at position n    X: RDRAW ( N -- ; 0<=N<=55 )               >R 7 1 108 R> 15 + MYBAR X;                                                  \ draw line in man'mtr at position n    X: LDRAW ( N -- )               \ ANIMATION WORDS        < 7/ 6/87>170  \ routines to animate manometer                                                    \ maximum value (ans)                40 XCONSTANT MANANS                        \ move manometer every n cycles      20 XCONSTANT MAN1                                 ELSE 200 0 DO NOOP NOOP LOOP            THEN                                  X;                                                                                                                                              \ ANIMATION WORDS        < 7/ 6/87>172  \ draw clock                                                                      \ change clock every CLKDEL cycles    3 XCONSTANT CLKDEL                        \ current clock value                   XVARIABLE CLKV- CLKAN I MANAN I RUNAN           LOOP                                  X;                                                                                                             \ FAH                                                                                                                                                                                                                                                                                                                                              IF 10 INT# @ / 1+ \ compute speed       ELSE 5000 THEN \ don't move             X' RUNDEL ! 0 BDRAW                     1 X' CLKINC ! 0 CLKVAL !                1 MAN# ! 0 RUN# ! RUN1                  CLKDEL 60 * 2+ 1                        DO I 1R >SCRPOS LINE-TO          LOOP X;                                                                      \ set exper position to current cursor  2 OWORD: \ EXPER-POS ( -- )               GX @ DUP 7 MOD - X' GPX !               GY @ X' GPY ! O;              @3GRAPHICS THEN           FILLMAN                                 INT# @ ML/G/HR TOPIX X' MANANS !        CLKCYCS MANANS / X' MANDEL !            CLKCYCS DUP MANDEL / 1+ MANANS - /      X' MANDEL2 !                            INT# @                        \ OVERLAY WORDS          < 7/ 9/87>175                                                                                  X: 0IDEAL                                  0 0 ML/G/HR >SCRPOS POINT               20 1                                    DO I I ML/G/H\ ANIMATION WORDS        < 7/ 8/87>173  \ master animation loop                                                         X: 0AN                                    TEMP# @ \ load animation graphics       IF 26 27 28 @3GRAPHICS                  ELSE 23 24 25                                                                                                                                                                                        \ FAH                                                                                                    X: CLKCYCS ( -- N )                       CLKDEL 60 * X;                                                                                                                                                                                                                                                                                                                                                                                                                                        ETMODE     CLKVAL @ G. GSPACE                      SETMODE GXYTAB CLKINC CLKVAL +!        ELSE                                     130 0 DO NOOP NOOP LOOP                THEN X;                                                                               OP                      X;                                                                                                                                                                                                                                      AL                      -1 XCONSTANT CLKINC                                                             X: CLKAN ( CYCLE -- )                     CLKDEL MOD 0=                           IF GXY@ GETMODE                          CLKXY D@ GXYTAB CLKXY 4 + @ S\ 0SHOW                  < 7/ 9/87>174                                                                                  X: 0SHOW                                   FILLMAN                                 MAN# @ 1+ 0                             DO I BDRAW LO                                                                                                                                                                                                                                                                \ OVERLAY WORDS          < 7/ 9/87>176                                                                                  3 OWORD: \ CLK-POS ( -- )                 GXY@ CLKXY D!                           GETMODE CLKXY 4 + !                   O;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ FAH      ù‹  v„  ñ|  ,v  #p  Új  Ñg  …e  ûc  ±d  èf  ^k  ×r  Ñ{  
‡                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            4 OWORD: \ GET-TEMP ( -- )                 TEMP @ TINT !                        O;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ DROPYEAST              < 7/ 9/87>180                                          X: MYBAR2 ( W H X Y -- )                   24 - MYBAR X;                                                                X: DROPIT ( -- )                           2MODE 15 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           X: 2SHOW                                   DROPIT 2AN X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                25 * +                       1MODE 0                                 DO 7 1 82 77 I - MYBAR2 LOOP          THEN                                 X;                                                                                                                                                                                                                                                                                                                                                                              \ 2AN                    < 7/ 9/87>181                                          X: 2AN ( N -- )                            DROPYEAST                               INT# @ 2 <                              IF INT# @ 0= 37 *                         INT# @ 1 =                                                                                                                                                                                                                                                                 T X;                                                                                                                                                                                   \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                            \ drop yeast from top into pot          X: DROPYEAST ( -- )                        1MODE 78 25                             DO 6 1 27 I MYBAR2 LOOP                 DROPI                                                                                                                                                                                                                                                                                           DO 19 1 20 I MYBAR2 LOOP                2MODE 24 15                             DO 6 1 27 I MYBAR2 LOOP                 2MODE 78 25                             DO 6 1 27 I MYBAR2 LOOP              X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               CLKVAL +! THEN                    CLKVAL @ INT# !                      X;                                                                                                                                                                                                 >R @CURSOR                              GPX 45 + GPY R> + !CURSOR               DX @ 0 DX ! 5 GEMIT DX !                !CURSOR X;                                                                                                                              WHILE CYCLE @ CLKAN                      0 <RUN1> 1 CYCLE +!                     100 0 DO NOOP LOOP                     REPEAT                                  1 RUN# ! 0 <RUN1>                       CLKVAL @ 0>                             IF -1 C, 65 C, 61 C,           57 C, 52 C, 47 C, 42 C, 37 C,           32 C, 26 C, 20 C, 14 C, 8 C,            3 C,                                                                                                                  X: DRPTR ( Y-OFS -- )            @3GRAPHICS                THEN                                    0 RUN# ! 0 CYCLE !                      0 CLKVAL ! 1 X' CLKINC !                BEGIN QTERM DUP                          IF DROP KEY BL = THEN 0=                CLKVAL @ 91 < AND           \ DRPOS                  < 7/13/87>187                                          \ table of gauge positions for          \ each of the values 0-20               XCREATE PTPOS                             92 C, 89 C, 86 C, 83 C, 80 C,           77 C, 73 C, 69\ 1AN                    < 7/ 9/87>185                                          XVARIABLE CYCLE                         X: 1AN ( -- )                              TEMP# @ 0= ( wimp or athlete )          IF 20 21 22 @3GRAPHICS                  ELSE 17 18 19;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ n is 0-30 for 0-90 mins               X: LACID ( N -- V*100 )                   TEMP# @ 0= \ wimp?                      IF WLA + C@                             ELSE \ compute for athlete               10 30 */ 40 +                          THEN X                                                                                                                                                                                                                                                                132 C, 128 C,             122 C, 120 C, 116 C, 110 C,             107 C, 103 C,  98 C,  95 C,              90 C,  86 C,  82 C,  79 C,              74 C,  70 C,  70 C,                                                                                                                                                                                                                                                                                                                                                          \ WLA LACID              < 7/13/87>186                                          XCREATE WLA \ wimp latic acid * 100        40 C,  50 C,  74 C,  85 C,              96 C, 110 C, 120 C, 130 C,             140 C, 150 C, 147 C, 144 C,             140 C, 136 C,                                                                                                                                                                                        \ FAH                                                                    \ 1SHOW                  < 7/13/87>188                                          X: MOVEPTR \ END-OFF --                    92                                      BEGIN DDUP <                            WHILE DUP DRPTR 2-                      REPEAT                                                                                                                                                                                                                                                                                  INT# @ @POIS PTPOS + C@ DOWNPTR      X;                                                                                                                                                                                                              O          LOOP X;                                                                                                                                                                                                                                               LOOP                      REPEAT                                  DROP DRPTR X;                                                                                                        X: 3AN                                     20 PTPOS + C@ ( DUP MOVEPTR )                                                                \ draw ideal curve for data             X: 1IDEAL                                  0 0 @LA >SCRPOS POINT                   30 1                                    DO I 3 * I @LA >SCRPOS LINE-T\ DOWNPTR                < 7/13/87>191                                          X: DOWNPTR \ START END --                  SWAP                                    BEGIN DDUP >                            WHILE DUP DRPTR 2+                       50 0 DO NOOP\ 1IDEAL                 < 7/16/87>189                                                                                  X: @LA ( N -- V*10 )                       LACID 3 * \ convert from absor          5 + 10 / X;                                                                                                                                                                                                                                 \ FAH                                                                                                                                                                                                                                                           \ FAH                                                                            X: @POIS ( N -- VAL )                     POIS + C@ X;                                                                                                                                                                                                             10 /MOD SWAP >R                         PTPOS + DUP C@ SWAP 1+ C@               OVER - ABS                              R> ?DUP                                 IF 10 */ - ELSE DROP THEN               MOVEPTR X;                                   inus toxin               18 C, \ 4-carbon monoxide                5 C, \ 5-curare                        18 C, \ 6-cyanide                        5 C, \ 7-penicillin                    18 C, \ 8-rotenone                                                                                DROP DRPTR X;                                                                                                        \ show answer                           X: 1SHOW ( -- )                            CLKVAL @ 3 / LACID           \ POIS @POIS             < 7/13/87>190                                          XCREATE POIS \ READING * 10               5 C, \ 0-control                       18 C, \ 1-antimycin A                   18 C, \ 2-arsenic                        5 C, \ 3-botul                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1 OWORD: \ GR-IDEAL                       EXP# @  0= IF 0IDEAL THEN               EXP# @ 1 = IF 1IDEAL THEN O;                                                  6 OWORD: \ FILL-MAN                       FILLMA                                                                                                                                                                                                                                                                3AN THEN O;                                                     5 OWORD: \ SHOW-ANS                       EXP# @  0= IF 0SHOW THEN                EXP# @ 1 = IF 1SHOW THEN                EXP# @ 2 = IF 2SHOW THEN                EXP# @ 3 = IF 3AN   THEN O;                                                                                                                                                                                                                                                                   \ RUN-EXPER              < 7/16/87>195                                          0 OWORD: \ RUN-EXPER                      EXP# @  0= IF 0AN THEN                  EXP# @ 1 = IF 1AN THEN                  EXP# @ 2 = IF 2AN THEN                  EXP# @ 3 = IF                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 N O;                                                                                                                                                                                                                                                            \ REMOVE HEADS           < 7/16/87>196                                                                                  [FORTH]                                                                         FORGET CLKXY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ ION NOTES              < 7/16/87>200                                          EXIT --------- notes ------------ EXIT                                                                                  copied from photosynthesis                                                                                                                                                                                                                     \ FAH                                                                               LOOP DROP X;                                                                                                                                                                                                                                                                                         X: ILN ( N -- )                            DUP IVL X;                                                                   X: IXP ( X1 X2 -- )                       IX + SWAP IX + SETENDPTS X;                   4 CMOVE                    LOOP DROP X;                                                                 X: BG-REST                                 IX 7 / 12 0                             DO DUP IY I + YADDR +                    PAD I 4 * + SWAP 4 CMOVE    TN \ light number                                               \ VARIABLE L1NXY 0 , 0 ,                \ VARIABLE L2NXY 0 , 0 ,                                                        X: IVL ( Y1 Y2 )                           IY + SWAP IY + VLINE X;      \ BG-SAVE BG-RESTORE     < 7/16/87>203                                                                                  X: BG-SAVE                                 IX 7 / 12 0                             DO DUP IY I + YADDR +                    PAD I 4 * + \ ION VARIABLES          < 7/16/87>201                                           120 XCONSTANT IX  \ ion x                40 XCONSTANT IY  \ ion y              \ 12 XCONSTANT LX  \ light X            \ 36 XCONSTANT LY  \ light Y            \  0 XCONSTANT LL2NXY @ L2NXY 2+ D@ <DRAW>      \  THEN X;                                                                                                                                             \ FAH                                                                                                                                                                                                                                                           \ FAH                                                                               9 11 IXP 3 ILN     \ hor +             10 10 IXP 2 4 IVL X; \ ver +                                                  \ X: DOLT                               \  LTN DUP NOT X' LTN !                 \  IF L1NXY @ L1NXY 2+ D@ <DRAW>        \  ELSE                                                                                                                                                                                                                                                                 LN  8 ILN                  0 14 IXP  4 7 IVL X;                                                         X: H+                                      3  3 IXP 3 8 IVL   \ left H             7  7 IXP 3 8 IVL   \ right H            3  6 IXP 5 ILN     \ middle H                        removed light drawing function                                                                                                                                                                                                          \ ION H+                 < 7/16/87>202                                          X: ION ( -- )                              5  9 IXP 0 ILN 11 ILN                   3 11 IXP  1 ILN 10 ILN                  2 12 IXP  2 ILN  9 ILN                  1 13 IXP  3 I                                                                                                                                                                                       \ FAH                                                                    \ ION-FLASH H+-FLASH     < 7/16/87>204                                          \ X: LTOFF                              \    0 L1NXY ! 0 L2NXY ! X;                                                     X: ION-FLASH                               BG-SAVE 1 SET                                                                                                                                                                                       \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    O;                                                              2 OWORD: ( IM H+M -- )                    IPOS GETMODE >R                         SWAP SETMODE ION SETMODE H+             R> SETMODE O;                                                                                                                                                                                                                                                                                                                         \                        < 7/16/87>205                                          0 OWORD: ( -- ; ION )                     IPOS ION-FLASH O;                                                             1 OWORD: ( -- ; H+ )                      IPOS H+-FLASH                                                                                                                                                                                        \ FAH                                                                                                                                                                                                                                                           \ FAH                                                                                                                                                                                                                                                                                                                                               DO ( DOLT ) ION LOOP                    BG-REST ( LTOFF ) X;                                                         X: IPOS                                    GX @ X' IX ! GY @ X' IY ! X;                                                                                                                                                                                                                                                                                                                         MODE ION 0 SETMODE         10 0 DO ( DOLT ) ION LOOP               BG-REST ( LTOFF ) X;                                                         X: H+-FLASH                                BG-SAVE 1 SETMODE ION                   2 SETMODE H+ 0 SETMODE 10 0  \ FORGET HEADS           < 7/16/87>206                                                                                  [FORTH]                                                                         FORGET IX                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               nd        a superscript.                        NOTE - you only have to end sub/super-         scripts if you have to print            more things after it                                                     ^ Causes the next letter to be centered   on the                                                                                                                                                                                                                                                                                        Within an string the following          characters have special meaning:                                                > will raise for superscripts and end     a subscript.                          < will drop for subscripts and e                                                                                                                                                                                                                                                                \ CHEMICAL PRINTER RULES < 7/16/87>211  EXIT _________________________________                                          To print a element at the current       location simply inclose it in sigle     quotes (like 'HC')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      _____   |                                    |  |    COPIED FROM PHOTOSYNTHESIS      |  |      WITHOUT CHANGE 7/16/87        |  |____________________________________|                                                                                                                                                                                                                                                                                                                                                          hed formula                                                     The plan is to implement the formula    printer by passing strings that         describe the nature of the molecule                                              _______________________________                                                                                                                                                                                                                                                                \ CHEMICAL PRINTER NOTES < 7/16/87>210  EXIT _________________________________                                          The idea behind these functions is to   provide an easy way to express the      chemical formulas that results in a     very clean polis current location. If ^ is        not present it is alligned on the       first character                                                                                              \ FAH                                                                    \ CHEMICAL PRINTER RULES < 7/16/87>212  EXIT _________________________________  All movement is relative to the current location and is specified as x and y    displacements and specified as follows                                          Cxy Where C is t                                                                                                                                                                                       \ FAH                                                                                                                                                                                                                                                                                                                                            -   Restore last saved location                                                                                                                                                                                                                          ^STR +! -1 CLEFT +!      ELSE 0 THEN X;                                                                \ read current character don't inc      X: LOOKCH \ -- C/0; returns zero if end   CLEFT @ 0>                              IF ^STR C@ ELSE 0 THEN X;      x location plus offset     o to table location n               Yno Save current y location plus offset     o to table location n                   - The above are used to label             portions of the molecule          +   Save current location       \ @CH LOOKCH             < 7/16/87>215                                                                                  \ read current character and inc ptr    X: @CH \ -- C/0; returns zero if end      CLEFT @ 0>                              IF ^STR C@ 1 '\ CHEMICAL PRINTER RULES < 7/16/87>213  EXIT _________________________________                                          The following special operations are    also defined:                                                                   Xno Save current subscripts raised              5 XCONSTANT SSAMT                                                                                                                                      \ FAH                                                                    t with a wide bond                                                      xy are specified with letters           A=1 Z=26 a=-1 z=-26 space=0                                            \ FAH                                                                                                                    \ holds current location                XVARIABLE MX                            XVARIABLE MY                                                                                                            \ amount        S connect with single bond              H connect with high energy bound          (ONLY WORK WHEN y is 0 ie straight)   T connect with a tapered bond             that starts 1 pix and wides op wide   R reverse taper wide to small           W connec vertical center offset                                                                                 \ pointer to current character          0 CONSTANT ^STR                         \ number of characters left in string   XVARIABLE CLEFT                 he type of movement     desired and xy is the amount of x and   y displacement                                                                  The following C's are defined                                                   D connect with double bond      \ CONSTANTS VARIABLES    < 7/16/87>214                                          \ leave first head so we have something \ to forget                             7 CONSTANT CW \ character width         8 XCONSTANT CH \ character heigth       4 XCONSTANT CC \                                                                                                                                                                                       \ FAH                                                                    \ ELSPC? ELPOS           < 7/16/87>216                                          X: ELSPC? \ C -- T/F; T if < > or ^       DUP 60 = OVER 62 = OR SWAP 94 = OR X;                                         XVARIABLE ELLEN \ len in pixs           XVARIABLE CPOS \ -- )                             ELPOS MX @ CPOS @ - MY @ CC - GXYTAB    PRSTR X;                                                                                                     \ FAH                                                                              COPYEND X;                                                                                                            \ just moves                            X: MDO                                    SETEND COPYEND X;                                                                             \ code for interpretting '              \ call with character pointing to       \ first char after ' increments         \ pointer to point to first char        \ after closing '                       X: 'DO (Y ;                       MEX @ MEY @ X;                                                                \ draw a single bound                   X: SDO ( -- )                             SETEND                                  @MXY @MEXY LINE               +! THEN 62 =                IF SSAMT NEGATE GY +! THEN             ELSE GETMODE 4 SETMODE                    SWAP GEMIT SETMODE                    THEN                                   REPEAT                                  @CH DROP X; \ terminating '   \ SDO MDO @MXY @MEXY     < 7/16/87>219                                                                                  X: @MXY \ -- X Y ;                        MX @ MY @ X;                                                                  X: @MEXY \ -- X \ PRSTR DO'              < 7/16/87>217                                          X: PRSTR \ -- print string                BEGIN LOOKCH DUP 39 = SWAP 0= OR NOT    WHILE @CH DUP ELSPC?                     IF DUP 60 =                              IF SSAMT GY TVAL DUP MSY ! MY @ + MEY ! X;                                          X: COPYEND \ set new point to last end    MEX @ MX ! MEY @ MY ! X;                                             \ FAH                                                                    S ! THEN                           ELSE CWIDTH CDELX + ELLEN +! THEN      REPEAT                                  R> CLEFT ! R> TO ^STR X;                                             \ FAH                                                                              DUP ASCII a ASCII z WITHIN              IF ASCII a - 1+ NEGATE EXIT THEN        1 ABORT" Bad offset" X;                                                       X: SETEND \ enter pointing to offsets     @CH GETVAL DUP MSX ! MX @ + MEX !       @CH GE          LOOKCH ELSPC? NOT                       IF LOOKCH ELWID CPOS ! THEN             BEGIN LOOKCH DUP 39 = SWAP 0= OR NOT    WHILE @CH DUP ELSPC?                     IF 94 = \ new centering pos?             IF LOOKCH ELWID ELLEN @ +                CPOter return its value    \ A to Z = 1 to 26 a to z = -1 to -26   \ space = 0                             X: GETVAL \ C -- V; aborts if error       DUP BL = IF DROP 0 EXIT THEN            DUP ASCII A ASCII Z WITHIN              IF ASCII A - 1+ EXIT THEN      center location        X: ELWID CWIDTH 2 /MOD + 1- X;          \ entered pointing to char after '      \ sets up text cursor to print the      \ element restores pointer              X: ELPOS ( -- )                           ^STR >R CLEFT @ >R 0 ELLEN !  \ MOVE DRAW PRIMS        < 7/16/87>218                                          XVARIABLE MEX \ ending x value          XVARIABLE MEY \ ending y value          XVARIABLE MSX \ rise                    XVARIABLE MSY \ run                     \ given a charac                                                                                                                                                                                       \ FAH                                                                    \ NSIGN MEL MER          < 7/16/87>220                                          X: NSIGN \ V -- -1/0/1;                   DUP                                     IF 0> 2* 1- THEN X;                                                           \ deal w/ this sER @MEXY LINE                     COPYEND X;                                                                                                                                           \ FAH                                                                                                                    X: -DO                                    OPOS D@ MY ! MX ! X;                                                                                                                                                            COPYEND X;                                                                    \ draw a reverse taper bond             X: RDO ( -- ) SETEND                      @MXY MEL @MEXY LINE                     @MXY @MEXY LINE                         @MXY M MX ! X;                                                                                                XVARIABLE OPOS 2 ALLOT                                                          X: +DO                                    @MXY OPOS D! X;                                                                               \ draw a taper bond                     X: TDO ( -- ) SETEND                      @MXY @MEXY MEL LINE                     @MXY @MEXY LINE                         @MXY @MEXY MER LINE           \ 0DO +DO -DO            < 7/16/87>223                                          \ set MX MY to current cursor position  \ clear up any other viables                                                    X: 0DO                                    GY @ MY ! GX @\ DOD TDO RDO            < 7/16/87>221                                          \ draw a double bond                    X: DOD ( -- ) SETEND                      @MXY MEL @MEXY MEL LINE                 @MXY MER @MEXY MER LINE                 COPYEND X;                                                                                                                                                                                           \ FAH                                                                     X Y -- X' Y'                     >R MSY @ NSIGN SCASE NEGATE +           R> MSX @ NSIGN + X;                                                                                          \ FAH                                                                                                                                                                                                                                                                                                                                            \ Return Point to the left              X: MEL \ X Y -- X' Y'                     >R MSY @ NSIGN SCASE +                  R> MSX @ NSIGN NEGATE + X;                                                    \ Return point to the right             X: MER \ MER LINE                 COPYEND X;                                                                    \ set color for bounds/braces           X: CDO ( -- )                             @CH GETVAL HCOLOR X;                                                  hit apple computer      X: SCASE \ N -- M                         MSX @                                   IF MSY @ ABS MSX @ ABS / 1 >            ELSE 1 THEN                             IF 2* THEN X;                                                         \ WDO CDO                < 7/16/87>222                                          \ draw a wide bond                      X: WDO ( -- ) SETEND                      @MXY MEL @MEXY MEL LINE                 @MXY @MEXY LINE                         @MXY MER @MEXY                                                                                                                                                                                       \ FAH                                                                    \ XDO YDO GDO            < 7/16/87>224                                          XCREATE MXYPOS 40 ALLOT                 : ^MXYPOS \ N -- ADR;                     DUP ASCII 0 ASCII 9 WITHIN NOT          ABORT" Bad index"                       ASCII 0 - 4 * OT 7 0                            DO SWAP I @XI + SWAP I @YI +              DDUP DOT LOOP X;                                                                                           \ FAH                                                                              >R <DOCOMD>                             BEGIN DUP C@ ?DUP                       WHILE R@ =                               IF R> DROP 1+ @ 2+ >R EXIT              THEN                                    3 +                                    REPEAT        X: @YI ( N -- V )                          XR IF 6 SWAP - THEN                     2* BC + 1+ C@ YR IF NEGATE THEN X;                                           \ do a corner XR YR decide orienatation X: BRC \ X Y -- X' Y';                    DDUP DDO [ ASCII Y C, ] YDO [   ASCII + C, ] +DO [ ASCII - C, ] -DO [   ASCII B C, ] BDO [ ASCII G C, ] GDO [   0       C, 0 ,                                                                \ execute code for char or error        X: DOCOMD ( C -- )                                      0 CONSTANT XR \ reverse x values        0 CONSTANT YR \ reverse y values                                                X: @XI ( N -- V )                          XR IF 6 SWAP - THEN 2* BC + C@ X;                                    \ DOCOMD                 < 7/16/87>227  XCREATE <DOCOMD>                          ASCII 0 C, ] 0DO [ ASCII ' C, ] 'DO [   ASCII S C, ] SDO [ ASCII M C, ] MDO [   ASCII D C, ] DOD [ ASCII T C, ] TDO [   ASCII R C, ] RDO [ ASCII W C, ] WDO [   ASCII X C, ] X\ BDO                    < 7/16/87>225                                          XCREATE BC                                0 C, 1 C, 1 C, 1 C, 0 C, 1 C,           1 C, 1 C, 1 C, 0 C, 1 C, 1 C,           1 C, 0 C,                                              ' expected'"                     ELPOS 2/ ELLEN @ 2/ - GX +!             YR IF -20 ELSE 10 THEN GY +!            PRSTR X;                                                             \ FAH                                                                                                                                                                                                                                                           \ FAH                                                                            X: BDO \ -- ;                             @CH ASCII 1 = TO YR                     @CH ^MXYPOS >R                          R@ @ R@ 2+ @ !CURSOR                    @CH ^MXYPOS @ R> @ - DUP BRACE          @CH ASCII ' = NOT                       ABORT"        X: YDO ( -- )                             @CH ^MXYPOS >R                          MY @ @CH GETVAL + R> 2+ ! X;                                                  X: GDO ( -- )                             @CH ^MXYPOS D@ MX ! MY ! X;                   UP DOT LOOP               1 TO XR BRC                             YR NOT TO YR 0 TO XR BRC                R> 0 DO >R 2+ R> DDUP DOT LOOP          1 TO XR BRC DDROP                       YR NOT TO YR R> SETMODE ;                                             MXYPOS + ;                                                      \ Xno - Saves MX plus offset o to n     X: XDO ( -- )                             @CH ^MXYPOS >R                          MX @ @CH GETVAL + R> ! X;                                             \ BRACE BDO              < 7/16/87>226  \ set YR to value before call           : BRACE \ LEN --                          GETMODE >R 1MODE 20 - 4 / >R            0 TO XR                                 @CURSOR BRC R@ 0                        DO >R 2+ R> DD                                  1 ABORT" BAD COMMAND"                 X;                                                                                                             \ FAH                                                                    \ DOFORM                 < 7/16/87>228                                          : DOFORM \ ADR -- ;                       COUNT CLEFT ! TO ^STR                   BEGIN LOOKCH                            WHILE @CH DOCOMD                        REPEAT ;                                                                                                                                                                                             \ FAH                                                                              CLC, BX LDA, SEC ADC, PHA,              BX 1+ LDA, SEC 1+ ADC,                  TAY, PLA, X' {BLW} JSR,                                                         XSAVE LDX,                              RTS,      XC;                                                                                 [FORTH]                                 FORGET CH \ REMOVE HEADS                                                                                                                                                point                     XSAVE STX,                              SEC, BX LDA, SEC SBC, PHA,              BX 1+ LDA, SEC 1+ SBC,                  TAY, PLA, X' {BLW} JSR,                                                         XSAVE LDX,                                              0                                       DO DUP >R EXEC @GMSG                      MSG-BUF DOFORM                          R> 1+                                 LOOP DROP                               EXEC CLEANUP FORTH O;         \ {BLOW}                 < 7/16/87>231  \ draws four points at                  \ (BX-XO,BY-YO), (BX+XO,BY-YO),         \ (BX-XO,BY+YO),& (BX+XO,BY+YO)                                                 XCODE {BLOW} \ XO YO -- XO YO ;           \ set left end\ CFORM                  < 7/16/87>229                                          \ use: CFORM mes, num                   \ will num messages starting with       \ mes from the current groupt and       \ will feed it to DOFROM                0 OWORD:        , SEC, BOT SBC, TAX,              ' $YADDR JSR, ' $HLINEB JSR,                                                    RTS, XC;                                                             \ FAH                                                                                                                                                                                                                                                           \ FAH                                                                                                                      XSAVE LDX,                              BY LDA, CLC, BOT ADC, TAX,              ' $YADDR JSR, ' $HLINEB JSR,                                                    XSAVE LDX,                              BY LDA                                                                                                                                                                                                                                                                LEFT.D7 STA,              LMASKS ,Y LDA, LEFT.MSK STA,                                                    N 2 + LDA, N 3 + LDY, \ its later       CLC, # 1  ADC, CS IF, INY, THEN,        ' $ENDPT  JSR, RIGHT.D7 STA,            RMASKS ,Y LDA, RIGHT.MSK STA,                                                                                                                                                                                                                                                                 \ BX BY {BLW}            < 7/16/87>230  VARIABLE BX \ center for explosion      VARIABLE BY                             \ .A = x coord lsb .Y=msb               XCODE {BLW} \ XO YO -- XO YO              N 2+ STA, N 3 + STY, \ save for later   ' $ENDPT JSR,                                                                                                                                                                                        \ FAH                                                                    \ XO YO #STEPS EP {>>5}  < 7/16/87>232                                          XCREATE XO \ y offsets from center        0 C, 27 C, 24 C, 24 C,                  16 C, 9 C, 4 C,                       XCREATE YO                                0 C, 6 C, 12 C                                                                                                                                                                                       \ FAH                                                                              WHILE EP @ IND DUP <BLOW> <BLOW>         1 EP +! REPEAT                         R> SETMODE ;                                                                  : EI2 \ --                                GETMODE >R 1MODE #STEPS 1               DO I I           N 1- DEC,                              0= UNTIL,                               BOT STA,                                RTS,                                  XC;                                                                                                               DO 1MODE I IND <BLOW> EP @ 0>            IF 2MODE EP @ IND <BLOW>                ELSE I IND <BLOW> THEN                  1 EP +!                                LOOP                                    BEGIN EP @ #STEPS <                                      .A ASL,                                 BOT 1+ ROL,                             N 1+ ASL,                               CS IF, CLC, N ADC,                       CS IF, BOT 1+ INC, THEN,               THEN,                        \ E/I IND EI1 EI2        < 7/16/87>235  1 CONSTANT E/I                          X: IND \ I -- I'                          E/I NOT IF #STEPS SWAP - THEN X;      : EI1 \ -                                 GETMODE >R -15 EP !                     #STEPS 1      \ {B*}                   < 7/16/87>233                                          \ Mult N by N1+ Place result at BOT     XCODE {B*} \ ?? -- [N]*[N+1]              8 # LDA, N 1- STA,                      0 # LDA, BOT STA, BOT 1+ STA,           BEGIN,        C,                                0= UNTIL,                               POP JMP, XC;                                                                                                 \ FAH                                                                                                    XC;                                                                                                                                                    \ FAH                                                                               BV 1+ LDA, N 1+ STA, ( l )              BV LDY, ( i )                           YO ,Y LDA, N STA,                       X' {B*} JSR, X' {>>5} JSR,              X' {BLOW} JSR,                          INX, INX,                               BV DE        XCODE {>>5} ( X -- X/32 )                 CLC, BOT 1+ ROR, BOT ROR,               CLC, BOT 1+ ROR, BOT ROR,               CLC, BOT 1+ ROR, BOT ROR,               CLC, BOT 1+ ROR, BOT ROR,               CLC, BOT 1+ ROR, BOT ROR,               RTS,   STA, ( l )               BEGIN,                                   BV 1+ LDA, N 1+ STA, ( l )              BV LDY, ( i )                           XO ,Y LDA, N STA,                       X' {B*} JSR, X' {>>5} JSR,              DEX, DEX,                    , 18 C,                   25 C, 28 C, 32 C,                                                             32 XCONSTANT #STEPS                     XVARIABLE EP                                                                    \ shift bot right five bits     \ <BLOW>                 < 7/16/87>234                                          XVARIABLE BV                            \ draws ray i at len l                  XCODE <BLOW> \ l -- ;                     6 # LDA, BV STA, ( i )                  BOT LDA, BV 1+ND <BLOW> LOOP                    2MODE #STEPS 1                          DO I IND <BLOW> LOOP                    R> SETMODE ;                                                         \ FAH                                                                    \ EXPLODE                < 7/31/87>236  \ use: EXPLODE type                     \ 1=Implosion type 3                    \ 2=Implosion type 4                    \ 3=Explosion type 1                    \ 4=Explosion type 2                                                                                                                                                                                                                                    U]U]U]www3;www3	               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   [FORTH] FORGET {BLW}                                                                                                    EXIT                                                                                                                                                                                                                                                                                                                                    \ EXPLEN                 < 7/31/87>237                                                                                                                          2 OWORD: ( N -- )                         X' #STEPS ! EX;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       EXIT                                    KEY: EXPLODE                              LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                             1 OWORD: \ T --                           GXY@  BY ! BX !                         DUP 2 > TO E/I                          1 AND IF EI1 ELSE EI2 THEN            O;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ TURNKEY NOTES          < 8/28/87>240                                          EXIT ---------------------------------                                          The system is compiled as an overlay    then overwritten as the next overlay    is loaded in.   PICS ! ;                                                                                                                                                                               \ FAH                                                                                                                                                                                                                                                                                                                                               36 EXEC WAIT FORTH                   \ Draw the prentice logo                   0 HCOLOR 280 10 0 182 BAR               4 0 105 <DRAW> 2  95 GXYTAB             G." Produced by:          "             48 EXEC WAIT FORTH                      12 '                            20 129 GXYTAB                           G." the disk from the disk drive."      FINS                                 ;                                                                                                               IT FORTH                \ draw the title screen                    2 0 105 <DRAW> 2 95 GXYTAB              G." CELLULAR RESPIRATION"               56 EXEC WAIT FORTH 8 182 GXYTAB         G."  Copyright (c) 1987 Holt "          G." Rinehart Winston "       \ FWRNG                  < 8/28/87>243                                          : FWRNG                                    0 HCOLOR 280 71 0 109 BAR               20 118 GXYTAB                                G." That is not the right disk. Remove"         \ TITLE                  < 8/28/87>241                                          : TITLE                                 \ draw the Holt logo                       HGR PAGE TEXT 60 ' PICS !               1 20 1 <DRAW> 3 0 105 <DRAW>            HG 36 EXEC WA                                                                                                                                                                                       \ FAH                                                                     used to check if the proper    disk is inserted                                                                                                                                       \ FAH                                                                               20 118 GXYTAB                                G." Remove side 1 of the Modern Biology"                                   20 129 GXYTAB                           G." disk from the disk drive."          FINS ;                                                                                       Turnkey is also repsonsible for         changing the disk error words to        look for the proper disk.                                                       The word PDISK? in the disk error       words isr, then press RETURN."     BEGIN KEY 13 = UNTIL                 ;                                                                               : FINST                                    0 HCOLOR 145 10 2  96 BAR                       280 71 0 109 BAR                                                                     TURNKEY draws the title screen          holt logo, prentice log, and the        directions to flip.  It then            verifies that the flip was made and     calls run to execute the program\ FINST                  < 8/28/87>242                                          : FINS                                     20 149 GXYTAB                           G." Insert side 2, close the disk"      20 160 GXYTAB                           G." drive doo                                                                                                                                                                                       \ FAH                                                                    \ FLIP                   < 8/28/87>244                                          : FLIP                                     FINST                                   BEGIN PDISK? NOT                        WHILE FWRNG                             REPEAT       start running virtuso code        RUN                                   ;                                                                                                                                                                                                 LOOP DROP FLUSH ;                                                             : QQ                                      HGR 0 0 GXYTAB                          G." Presents" GCR GCR                 ;                                                         \ set disk error words for side 2       20562 TO DID 0 TO DBLK 2 TO DS          \ now flip the disk                     FLIP                                    \ set reset to jump to the menu         ' RUN CFA ' BRK-RETN !                  \ now                                                                 : !8K ( N -- )                            ?NUM 8 0                                DO DUP I + BUFFER                        8192 I 1024 * + SWAP 1024 CMOVE         UPDATE                        TO DBLK 1 TO DS          \ make sure the right disk is in 1      INSDISK                                 \ set reset to restart from scratch     \ assumes ABORT points to TURNKEY       ' ABORT @ ' BRK-RETN !                  TITLE \ draw title            \                        <12/29/86>207  EXIT                                    : @8K ( N -- )                            ?NUM 8 0                                DO DUP I + BLOCK                         8192 I 1024 * + 1024 CMOVE             LOOP DROP ;   \ TURNKEY                < 8/28/87>245                                          : <TURNKEY>                               256 @ 1234 =                            IF ." HI FRED" CR <ABORT> THEN          \ set disk error words for side 1       16978 TO DID 3                                                                                                                                                                                       \ FAH                                                                                                                                                                                                                                                           \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ;                                                                                                                                                                                                                                       \                        < 8/25/87>246                                                                                  ' <TURNKEY> CFA ' TURNKEY 4 + !                                                                                                                                                                                                                                                                                                                                                                                                                                                         EXIT                                    : LCKEY                                   <KEY> DUP ASCII - =                     IF <KEY> 32 + THEN                    ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ SPECIAL TEST CODE      <10/ 6/87>260                                          \ If closed apple is pressed switch     \ to text mode, print info and wait     \ for the key to be released                                                    : DEMON ( -- )                                                                                                                                                                                         \ FAH                                                                            ' RCD CFA ' RUN-CODE 16 + !                                                                                             -->                                                                                                                             RM      ' DQ CFA ' QTERM CFA 8 CMOVE            FORGET DQ                                                                                                               -->                                                                                                             : RCD                                      DEMON                                   EXEC {run-code} ( REPLACED WORD )    ;                                                                                                                                       \ this word reads keyboard status       : DOQTERM ( -- DOES QTERM )               49152 C@ 127 > ;                                                              : DQ DEMON DOQTERM ;                    \ move def of DQ over def of QTE\ SPECIAL TEST CODE      <10/ 6/87>263                                          \ hook demon into virtuoso main loop    \ by hooking into RUN-CODE                                                                                                              \ SPECIAL TEST CODE      <10/ 6/87>261                                          \ hook demon into qterm by moving       \ a forth definition in over the        \ code defintion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ FAH                                                                            : DK                                      <key> ;                               \ move def of DQ over def of QTERM      ' DK CFA ' <KEY> CFA 8 CMOVE            FORGET DK                                                                       -->                UNTIL HG                               THEN ;                                                                                                                -->                                                                                                             ' <KEY> ' key 14 CMOVE ( move def )     ' key DUP CFA !  ( make it a code def)                                          : <key>                                   BEGIN QTERM UNTIL key ;                                                                         49250 C@ 127 > ( CLSD APPLE? )          IF TEXT CR                               ." RP@ = " RP@ U.                       ." SP@ = " SP@ U.                       ." GSTACK = " EXEC GSTACK @ U. FORTH    BEGIN 49250 C@ 127 > NOT     \ SPECIAL TEST CODE      <10/ 6/87>262                                          \ hook demon into <key> by moving       \ new definition over old                                                       ( copy of old <KEY> code )              : key ; 16 ALLOT                                                                                                                                                                                       \ FAH                                                                    \ SPECIAL TEST CODE      <10/ 6/87>264                                                                                                                          \ set vars to protect test code from    \ overwriting                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [FORTH] OVSET                           MARK-FORGET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               RUN-EXPER                                                                       AT 14 , 30 GRAPHIC 39                   SHOW-ANS                              END                                                                                                                                                                                                                                                                                                                                                     OCK-POS PRINT "0"         AT 0 , 140 PRINT "TEMP#="               SET-RANGE 0 , 1 INPUT TINT              SET-TEMP# TINT                        \ AT 0 , 150 PRINT "INT#="              \ SET-RANGE 0 , 20 INPUT TINT           \ SET-INT# TINT                                                                                                                                                                                                                                                                                 \ TEST EXPER-TYPE 1      < 7/ 9/87>271                                                                                                                          BEGIN EXPER-TYPE 1                        AT 14 , 30 EXPER-POS \ GRAPHIC 30       AT 200 , 30 CL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          RUN-EXPER                             END                                                                                                                                                                                                                                                                                                                                                                                                                                                                             OCK-POS PRINT "0"         AT 0 , 140 PRINT "TEMP#="               SET-RANGE 0 , 1 INPUT TINT              SET-TEMP# TINT                          AT 0 , 150 PRINT "INT#="                SET-RANGE 0 , 20 INPUT TINT             SET-INT# TINT                                                                                                                                                                                                                                                                                 \ TEST EXPER-TYPE 0      < 7/ 8/87>270                                                                                                                          BEGIN EXPER-TYPE 0                        AT 14 , 30 EXPER-POS GRAPHIC 30         AT 200 , 30 CL                                                                                                                                                                                                                                                                \ TEST EXPER-TYPE 2      < 7/ 6/87>272                                                                                                                          BEGIN EXPER-TYPE 2                        AT 14 , 30 EXPER-POS GRAPHIC 32         AT 28 , 6 GRAP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          CLEANUP                               EX;                                                                             0 INT: GR-IDEAL                         \ LOADER INSCR? !EXCODE ;                                                                         AT 0 , 150 PRINT "INT#="                SET-RANGE 0 , 20 INPUT TINT             SET-INT# TINT                           RUN-EXPER                                                                     END                             \ GR-IDEAL               <12/23/86>275                                          EXCODE:                                   BUB/MAN @ 2 =                           IF 4 4 OEXEC                            ELSE 6 0 OEXEC                          THEN          \ TEST EXPER-TYPE 3      < 7/13/87>273                                                                                                                          BEGIN EXPER-TYPE 3                        AT 14 , 30 EXPER-POS GRAPHIC 39                                                                                                                                                                                                              \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    !EXCODE ;                                                                                                                                                                                                                                                       HIC 31                    AT 0 , 150 PRINT "INT#="                SET-RANGE 0 , 20 INPUT TINT             SET-INT# TINT                           RUN-EXPER                                                                     END                             \ 4: METER-POS           <12/23/86>274                                          EXCODE: ( -- )                            3 4 OEXEC EX;                                                                 0 INT: METER-POS                        \ LOADER INSCR?                                                                                                                                                                                        \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    